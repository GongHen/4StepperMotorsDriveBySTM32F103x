
// 保持转矩的含义：
// 是指步进电机通电但没有转动时，定子锁住转子的力矩。它是步进电机最重要的参数之一，通常步进电机在低速时的力矩接近保持转矩。由于步进电机的输出力矩随速度的增大而不断衰减，输出功率也随速度的增大而变化，所以保持转矩就成为了衡量步进电机最重要的参数之一。比如，当人们说2N.m的步进电机，在没有特殊说明的情况下是指保持转矩为2N.m的步进电机。
// 定位转矩的含义：
// 是指步进电机没有通电的情况下，定子锁住转子的力矩。
// 通俗点讲：保持转矩就是电机在通电但没有运行的情况下，转动电机所需的力矩
// 定位转矩则是电机在没有通电情况下，转动电机所需的力矩


// 开环控制
// void Delay_Change(u16 time_span)
// {
//	while(time_span--)
//	{
//		delay_us(10);
//	}
// }

// direction = 1;
// speed = 70;

// 以上为默认参数

// 电机X



// 电机Y



// 电机Z

// 遇到问题，联调程序中，单个电机独自运行就很好，但是三个电机一起联动运行就会出错；
// 初步判断是电机的启动频率未设定好，直接设定为了电机的运行频率；（系统不可能以运行速度【往往高于启动速度】直接启动）

// 先一个电机带负载，一个电机空载看程序是否能正常运行；或者三个步进电机空载运行，看电机是否正常运行；

// 失步应该就是漏掉了脉冲没有运动到指定的位置。（启动的时候）
// 过冲应该就是和失步相反，运动到超过了指定的位置。（停止的时候）
// 开环控制，没有反馈，步进电机就必须正确响应每次励磁变化。如果励磁频率选择不当，步进电机就不能够移动到新的位置。负载实际的位置相对于控制器所期待的位置出现永久误差，即发生失步现象或过冲现现象。

// 为了克服步进失步和过冲现象，应该在启动停止时加入适当的加减速控制。

// 空载启动频率，即步进电机在空载情况下能够正常启动的脉冲频率。
// 在有负载的情况下，启动频率应更低。

// 所以，先测试电机的空载频率，再适当降低作为带载启动频率，然后一点点加速，直至正常启动？

// 启动频率 = 启动转速 × 每转多少步空载启动转速

// 步进电机都有共振区，一般其转速在每分钟60转到120转之间（一定频率区间内）。就会有强烈的振动和噪音。为了避免这一现象一般是避开这一工作频率。如果工作环境必需是这一工作区，普遍的做法是用带细分的驱动器或者用阻尼器。用这两种方法可以很好的解决共振的问题。加减速器也可以实现，但会有力矩丢失问题。所以实际应用中还是用驱动器细分技术比较普遍。

// 我觉得步进电机还是能带动负载的，毕竟单个独立运行就可以，选型上面没有问题。

// 排除法：
// 1.步进电机本身工作力矩不够，没有足够能力带动负载；		---->No,单个可以带动负载；（频率大概是1250Hz） 

// 2.步进电机起停的加减速过程不充分，步进电机在加减速过程中失步； ---->Yes，三个电机联动，只有一个电机抖动！ 

// 3.步进电机的电源功率不够导致步进电机的输入功率不够引起失步；   
		---->Yes，电源电压8.4v，带的动三个带载得电机？
		---->步进电机驱动器输入电压一般是要稍稍高于步进电机额定电压

// 4.步进电机的驱动电压不够或者驱动电流设定过低； 		
		---->Yes，也有可能是电流小了(空载同时运行，0.62A,0.65A,0.42A/L289N定电流的，Z轴只接一个驱动器，同样输出0.42A)，电机驱动电流不够，带不了载（没测过）

		---->步进电机需要快速启动或者高速运行，需要驱动电压比较高，工作电流设定值足够大，否则也容易失步。

// 5.驱动器或者控制器收到信号干扰； 				---->No，这个应该不会吧，可以测试三轴电机空载运行

// 6.步进电机系统共振引起步进电机带负载能力下降而导致失步； 	---->No，6ms转8个步距角，这已经不在共振区间了吧

// 7.驱动器和控制器的信号不匹配； 				---->No，这个还真不知道，但是我的驱动器接线对了，应该也是好的呀

// 8.同步轮或者减速箱的背隙或者来回转到的间隙误差没有在程序上补偿或者补偿值不对； ---->No，我就没加这些玩意儿，等等，这些都是啥？

// 9.控制程序本身有问题。	---->Yes，未加加减速过程/程序软件调试脉冲很怪，电机引脚在很短得时间内会被清0，额呵呵我让它清0的，怕IO口冲突）


// 呵呵呵，还真是驱动电压不足（驱动电流三者都是定电流）！