STM32的定时器除了TIM6 和TIM7。其他的定时器都可以用来产生PWM输出。

利用stm32定时器TIMx产生PWM流程

相关寄存器：

1. 定时器中断相关寄存器；
2. 2个捕获/比较模式寄存器（TIMx_CCMR1 & TIMx_CCMR2）
3. 一个捕获/比较使能寄存器（TIMxCCER）
4. 4个捕获/比较寄存器（TIMx_CCR1~4）

1.捕获/比较模式寄存器（TIMx_CCMR1控制CH1/CH2 & TIMx_CCMR2控制CH3/CH4）:

设置OCxM-->110/111,PWM模式，输出电平极性相反


2.捕获/比较使能寄存器（TIMxCCER）
设置CC2E-->1，使能PWM从IO口输出


3.捕获/比较寄存器（TIMx_CCR1~4）
以TIMx_CCR1为例，该寄存器的值与CNT的值作比较，以控制PWM的输出脉宽！！！


TIMx的CHx输出默认是接在某个引脚上（复用功能），这个时候，想要达到以我们自己设定的引脚输出PWM，则需要设置重映射和调试IO配置寄存器；
（重映射也只能重映射到特定端口，可以查手册）


具体过程：
1.开启TIMx时钟以及复用功能时钟，配置PXx为复用输出；
（默认你只要开启GPIOx那种普通时钟就行，但是注意，如果需要对PWM的输出进行重映像的话，还需要开启引脚复用时钟AFIO）

2.如果又需要，设置TIMx_CHx的重映射到PXx上

3.初始化TIMx，设置TIMx的ARR和PSC(参考定时器中断)

4.设置TIMx_CHx的PWM模式，使能TIMx的CHx（通道x）输出

5.使能TIMx

// PWM开始输出_|—|_|—|_|—|_

6.修改TIM3_CCR2来设置占空比

// 测试一下，当TIMx某个通道CHx对应引脚输出pwm后,其它通道对应引脚是否可以作普通IO
// 经测试，是可以的！



